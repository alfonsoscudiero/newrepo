<% /* =============================================
  views/account/management.ejs
  Module 06 Week 09
  Account Management landing page
  ============================================= */ %>

<h1><%= title %></h1>

<!-- Flash message area  -->
<%- messages() %>

<!-- Server-side validation errors (if any) -->
<% if (errors && errors.array) { %>
  <ul class="notice-registration">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <% }) %>
  </ul>
<% } %>

<h2>Welcome <%= accountData.account_firstname %></h2>
<p>You're logged in.</p>

<div class="acct-links">
  <p><a class="acct-link" href="/account/update/<%= accountData.account_id %>">Update Account Information</a></p>

  <!-- Inventory Management: ONLY for Employee/Admin -->
  <% if (accountData.account_type === 'Employee' || accountData.account_type === 'Admin') { %>
    <h3>Inventory Management</h3>
    <p>
      <a class="acct-link" href="/inv/">Go to Inventory Management</a>
    </p>
  <% } %>

  <!-- Reviews Section -->
  <!-- Final Project | week 13 -->
  <% if (accountData && accountData.account_id) { %>
    <h3>My Reviews</h3>

    <% if (accountReviews && accountReviews.length > 0) { %>
      <!-- Ordered list of the user's reviews -->
      <ul class="account-reviews-list">
        <% accountReviews.forEach(function (review) { %>
          <li class="account-review-item">
            <div class="account-review-text">
              Reviewed the <%= review.inv_year %> <%= review.inv_make %> <%= review.inv_model %> on <%= review.formatted_review_date %> 
            </div>
            <div class="account-review-actions">
              <a class="btn-review" href="/review/edit/<%= review.review_id %>" >Edit</a>
              <a class="btn-review btn-review-delete" href="/review/delete/<%= review.review_id %>">Delete</a>
            </div>
          </li>
        <% }) %>
      </>
    <% } else { %>
      <!-- User is logged in but has no reviews yet -->
      <p class="account-reviews-empty">
        You haven't written any reviews yet.
      </p>
    <% } %>  

  <% } %><!-- end review block -->
</div> <!-- end .acct-links -->




